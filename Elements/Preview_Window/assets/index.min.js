 var SAPreviewWindow = function($scope, $) {
    var SApreviewImageElem = $scope.find(".sa-el-preview-image-wrap"),
      previewImageMagSettings = SApreviewImageElem.data("settings"),
      previewImageOffset = $(SApreviewImageElem).offset().left,
      windowWidth = $(window).outerWidth(),
      minWidth = null,
      maxWidth = null;

    if (windowWidth <= 768) {
      minWidth = previewImageMagSettings["minWidthMobs"];
      maxWidth = previewImageMagSettings["maxWidthMobs"];
    } else if (windowWidth > 768 && $(this).outerWidth() <= 1024) {
      minWidth = previewImageMagSettings["minWidthTabs"];
      maxWidth = previewImageMagSettings["maxWidthTabs"];
    } else {
      minWidth = previewImageMagSettings["minWidth"];
      maxWidth = previewImageMagSettings["maxWidth"];
    }

    if (previewImageMagSettings["responsive"]) {
      if (previewImageOffset < previewImageMagSettings["minWidth"]) {
        var difference =
          previewImageMagSettings["minWidth"] - previewImageOffset;
        previewImageMagSettings["minWidth"] =
          previewImageMagSettings["minWidth"] - difference;
      }
    }

    SApreviewImageElem.find(".sa-el-preview-image-inner-trig-img").tooltipster({
      functionBefore: function() {
        if (
          previewImageMagSettings["hideMobiles"] &&
          $(window).outerWidth() < 768
        ) {
          return false;
        }
      },
      functionInit: function(instance, helper) {
        var content = $(helper.origin)
          .find("#tooltip_content")
          .detach();
        instance.content(content);
      },
      functionReady: function() {
        $(".tooltipster-box").addClass(
          "tooltipster-box-" + previewImageMagSettings["id"]
        );
      },
      contentCloning: true,
      plugins: ["sideTip"],
      animation: previewImageMagSettings["anim"],
      animationDuration: previewImageMagSettings["animDur"],
      delay: previewImageMagSettings["delay"],
      trigger: "custom",
      triggerOpen: {
        tap: true,
        mouseenter: true
      },
      triggerClose: {
        tap: true,
        mouseleave: true
      },
      arrow: previewImageMagSettings["arrow"],
      contentAsHTML: true,
      autoClose: false,
      maxWidth: maxWidth,
      minWidth: minWidth,
      distance: previewImageMagSettings["distance"],
      interactive: previewImageMagSettings["active"],
      minIntersection: 16,
      side: previewImageMagSettings["side"]
    });
  };

jQuery(window).on("elementor/frontend/init", function() {
	elementorFrontend.hooks.addAction(
		"frontend/element_ready/sa_el_preview_window.default",
		SAPreviewWindow
	);
});
