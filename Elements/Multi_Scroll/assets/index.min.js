var SaElMultiScroll = function($scope, $) {
    var SaElScrollElem = $scope.find(".sa-el-multiscroll-wrap"),
        SaElScrollSettings = SaElScrollElem.data("settings"),
        
        id = SaElScrollSettings["id"],
        winWidth = $(window).outerWidth();
    function SaelLoadMultiScroll() {
        $("#sa-el-scroll-nav-menu-" + id).removeClass(
            "sa-el-scroll-responsive"
        );
        $("#sa-el-multiscroll-" + id).CustomMultiscroll({
            verticalCentered: true,
            menu: "#sa-el-scroll-nav-menu-" + id,
            sectionsColor: [],
            keyboardScrolling: SaElScrollSettings["keyboard"],
            navigation: SaElScrollSettings["dots"],
            navigationPosition: SaElScrollSettings["dotsPos"],
            navigationVPosition: SaElScrollSettings["dotsVPos"],
            navigationTooltips: SaElScrollSettings["dotsText"],
            navigationColor: "#000",
            loopBottom: SaElScrollSettings["btmLoop"],
            loopTop: SaElScrollSettings["topLoop"],
            css3: true,
            paddingTop: 0,
            paddingBottom: 0,
            normalScrollElements: null,
            touchSensitivity: 5,
            leftSelector: ".sa-el-multiscroll-left-" + id,
            rightSelector: ".sa-el-multiscroll-right-" + id,
            sectionSelector: ".sa-el-multiscroll-temp-" + id,
            anchors: SaElScrollSettings["anchors"],
            fit: SaElScrollSettings["fit"],
            cellHeight: SaElScrollSettings["cellHeight"],
            id: id,
            leftWidth: SaElScrollSettings["leftWidth"],
            rightWidth: SaElScrollSettings["rightWidth"]
        });
    }
    var leftTemps = $(SaElScrollElem).find(".sa-el-multiscroll-left-temp"),
        rightTemps = $(SaElScrollElem).find(".sa-el-multiscroll-right-temp"),
        hideTabs = SaElScrollSettings["hideTabs"],
        hideMobs = SaElScrollSettings["hideMobs"],
        deviceType = $("body").data("elementor-device-mode");

    function SaelHideSections(leftSec, rightSec) {
        if ("mobile" === deviceType) {
            $(leftSec).data("hide-mobs") ?
                $(leftSec).addClass("sa-el-multiscroll-hide") :
                "";
            $(rightSec).data("hide-mobs") ?
                $(rightSec).addClass("sa-el-multiscroll-hide") :
                "";
        } else {
            $(leftSec).data("hide-tabs") ?
                $(leftSec).addClass("sa-el-multiscroll-hide") :
                "";
            $(rightSec).data("hide-tabs") ?
                $(rightSec).addClass("sa-el-multiscroll-hide") :
                "";
        }
    }

    function SaelreOrderTemplates() {
        $(SaElScrollElem)
            .parents(".elementor-top-section")
            .removeClass("elementor-section-height-full");
        $.each(rightTemps, function(index) {
            SaelHideSections(leftTemps[index], rightTemps[index]);
            if (SaElScrollSettings["rtl"]) {
                $(leftTemps[index]).insertAfter(rightTemps[index]);
            } else {
                $(rightTemps[index]).insertAfter(leftTemps[index]);
            }
        });
        $(SaElScrollElem)
            .find(".sa-el-multiscroll-inner")
            .removeClass("sa-el-scroll-fit")
            .css("min-height", SaElScrollSettings["cellHeight"] + "px");
    }

    switch (true) {
        case hideTabs && hideMobs:
            if (deviceType === "desktop") {
                SaelLoadMultiScroll();
            } else {
                SaelreOrderTemplates();
            }
            break;
        case hideTabs && !hideMobs:
            if (deviceType === "mobile" || deviceType === "desktop") {
                SaelLoadMultiScroll();
            } else {
                SaelreOrderTemplates();
            }
            break;
        case !hideTabs && hideMobs:
            if (deviceType === "tablet" || deviceType === "desktop") {
                SaelLoadMultiScroll();
            } else {
                SaelreOrderTemplates();
            }
            break;
        case !hideTabs && !hideMobs:
            SaelLoadMultiScroll();
            break;
    }
};

jQuery(window).on("elementor/frontend/init", function() {
    elementorFrontend.hooks.addAction(
        "frontend/element_ready/sa_el_multi_scroll.default",
        SaElMultiScroll
    );

});